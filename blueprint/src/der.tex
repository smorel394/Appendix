\chapter{Section A.3: homological algebra calculations and functor reconstruction}

This section corresponds to the Lean files \url{Acyclic.lean} and \url{Derived.lean}.

\section{$T$-acyclic objects}

Let $\Df,\Df'$ be triangulated categories and $T\colon \Df\ra\Df'$ be a triangulated functor. Suppose that we are given a t-structure 
$(\Df^{\leq 0},\Df^{\geq 0})$ (resp. $({\Df'}^{\leq 0},{\Df'}^{\geq 0})$) on $\Df$ (resp. $\Df'$), and denote the cohomology functors of 
this t-structure by $\H^i_t$ (resp. $\H^i_{t'}$) and its heart by $\Df^\heart$ (resp. ${\Df'}^\heart$).

\begin{definition}
\label{def-acyclic}
\lean{CategoryTheory.Triangulated.TStructure.Acyclic}

We say that an object $X$ of $\Df^\heart$ is \emph{$T$-acyclic} if $T(X)$ is in ${\Df'}^\heart$.

\end{definition}

\begin{lemma}
\label{prop-acyclic-H}
\lean{CategoryTheory.Triangulated.TStructure.isZero_homology_of_acyclic}
\leanok 
\uses{def-acyclic}
If $X$ is a $T$-acyclic object and $n\ne 0$ is an integer, then $\H^n_{t'}(F(X))$ is zero.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}

Note that the converse is true if the t-structure $t'$ is non-degenerate, but not in general.

Lemma A.3.1(i) says that the full subcategory of $T$-acyclic objects is stable by extensions. In Lean, we 
also need to prove the "obvious" facts that it is stable by isomorphisms, binary products and contains zero objects,
hence is an additive category.

\begin{lemma}
\label{prop-acyclic-iso}
\lean{CategoryTheory.Triangulated.AcyclicCategory.instIsClosedUnderIsomorphismsHeartAcyclic}
\leanok 
\uses{def-acyclic}
The full subcategory of $T$-acyclic objects is closed under isomorphisms.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic-zero}
\lean{CategoryTheory.Triangulated.AcyclicCategory.zero}
\leanok 
\uses{def-acyclic}
Zero objects are $T$-acyclic.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic-prod}
\lean{CategoryTheory.Triangulated.AcyclicCategory.prod}
\leanok 
\uses{def-acyclic}
The full subcategory of $T$-acyclic objects is closed under binary products.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
%Lemma A.3.1(i)
\label{prop-acyclic-extension}
\lean{CategoryTheory.Triangulated.TStructure.extension_acyclic_of_acyclic}
\leanok 
\uses{def-acyclic}
The full subcategory of $T$-acyclic objects is closed under extensions.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{definition}
\label{def-hTh}
\lean{CategoryTheory.Functor.fromHeartToHeart}
The functor $T':\Df^\heart\to{\Df'}^\heart$ given by the restriction of $\H^0_{t'}\circ T$.

\end{definition}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{definition}
\label{def-fromAcyclic}
\lean{CategoryTheory.Functor.fromAcyclic}
The functor $T''$ from the full subcategory of $T$-acyclic objects to 
${\Df'}^\heart$ given by the restriction of $T$.

\end{definition}


Lemma A.1.3(ii):

\begin{lemma}
%Lemma A.3.1(ii)
\label{prop-acyclic-shortexact_aux}
\lean{CategoryTheory.Functor.map_shortExact_exact}
\leanok 
\uses{def-hTh, def-acyclic}
The image by the functor $T'$ of Definition~\ref{def-hTh} of a short exact complex of $T$-acyclic objects
is an exact complex in ${\Df'}^\heart$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{remark}
Lemma A.3.1(ii) actually says that the image is short exact, which we do not prove yet.
See the next statements.

\end{remark}


\begin{lemma}
\label{prop-mono_map_of_mono_and_acyclicCokernel}
\lean{CategoryTheory.Functor.mono_map_of_mono_and_acyclicCokernel}
\leanok 
\uses{def-hTh, def-acyclic}
The image by the functor $T'$ of Definition~\ref{def-hTh} of a monomorphism with an acyclic 
cokernel is a monomorphism.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-epi_map_of_epi_and_acyclicKernel}
\lean{CategoryTheory.Functor.epi_map_of_epi_and_acyclicKernel}
\leanok 
\uses{def-hTh, def-acyclic}
The image by the functor $T'$ of Definition~\ref{def-hTh} of an epimorphism with an acyclic 
kernel is an epimorphism.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
%Lemma A.3.1(ii)
\label{prop-acyclic-shortexact}
\lean{CategoryTheory.Functor.map_shortExact_of_shortExact_and_acyclic}
\leanok 
\uses{def-hTh, def-acyclic}
The image by the functor $T'$ of Definition~\ref{def-hTh} of a short exact complex of $T$-acyclic objects
is a short exact complex in ${\Df'}^\heart$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


For the proof of Lemma A.1.3(iii), we need a number of facts about preservation of kernels/cokernels/etc.
First we prove a statement about preservation of images.

\begin{definition}
\label{def-acyclic-image}
\lean{CategoryTheory.Functor.isoImageOfAcyclic}
\leanok 
\uses{def-hTh, def-acyclic}
If a map $f$ in $\Df^\heart$ has an acyclic kernel and an acyclic cokernel, then
the functor $T'$ of Definition~\ref{def-hTh} preserves the image of `$f$.

\end{definition}

\begin{remark}
This isomorphism is not given by \url{CategoryTheory.PreservesImage.iso}, because we do not yet know at this 
point that the kernel and the cokernel of $f$ are preserved. So we actually construct an image factorization of
$T'(f)$ by hand in \url{imageFactorisation_map_of_acyclic_ker_coker} which has the desired image. Then we need
to check that the isomorphism of Definition~\ref{def-acyclic-image} is compatible with \url{Abelian.image.ι}
and \url{Abelian.factorThruImage}, this is done in \url{CategoryTheory.Functor.isoImageOfAcyclic_comp_ι}
and \url{CategoryTheory.Functor.factorThruImage_comp_isoImageOfAcyclic}.

\end{remark}

We then look at the preservation of kernels and cokernels.

\begin{lemma}
\label{prop-mono_kernelComparison_of_acyclic_image}
\lean{CategoryTheory.Functor.mono_kernelComparison_of_acyclic_image}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with an acyclic image, then its kernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is a mono.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-epi_kernelComparison_of_acyclic_homology}
\lean{CategoryTheory.Functor.epi_kernelComparison_of_acyclic_homology}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with a $T$-acyclic image, a $T$-acyclic kernel and a $T$-acyclic cokernel,
then its kernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is an epi.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-isIso_kernelComparison_of_acyclic_homology}
\lean{CategoryTheory.Functor.isIso_kernelComparison_of_acyclic_homology}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with a $T$-acyclic image, a $T$-acyclic kernel and a $T$-acyclic cokernel,
then its kernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is an isomorphism.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-epi_cokernelComparison_of_acyclic_image}
\lean{CategoryTheory.Functor.epi_cokernelComparison_of_acyclic_image}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with an acyclic image, then its cokernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is an epi.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-mono_cokernelComparison_of_acyclic_homology}
\lean{CategoryTheory.Functor.mono_cokernelComparison_of_acyclic_homology}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with a $T$-acyclic image, a $T$-acyclic kernel and a $T$-acyclic cokernel,
then its cokernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is a mono.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-isIso_cokernelComparison_of_acyclic_homology}
\lean{CategoryTheory.Functor.isIso_cokernelComparison_of_acyclic_homology}
\leanok 
\uses{def-hTh, def-acyclic}
If $f$ is a morphism in $\Df.heart$ with a $T$-acyclic image, a $T$-acyclic kernel and a $T$-acyclic cokernel,
then its cokernel comparison morphism
for the functor $T'$ of Definition~\ref{def-hTh} is an isomorphism.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{definition}
\label{def-shortExact_connecting_iso}
\lean{CategoryTheory.Functor.shortExact_connecting_iso}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a short exact sequence in $\Df^\heart$ whose second object $S.X_2$ is $T$-acyclic. Then, for every 
$n\in\Z$, the connecting
morphism in the long exact sequence of homology of the distinguished triangle in $\Df'$ image of $S$ by $T$
(i.e. given by \url{CategoryTheory.Functor.shortExactComplex_to_triangle}) is an isomorphism from $n$th homology of
$T(S.X_3)$ to the $(n + 1)$st homology of $T(S.X_1)$.
\end{definition}

Lemma A.1.3(iii):

\begin{definition}
%Lemma A.1.3(iii)
\label{def-iso_cohomology_of_acyclic_and_exact}
\lean{CategoryTheory.Functor.iso_cohomology_of_acyclic_and_exact}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$, and let $r\in\Z$. 
Suppose that $S$ is exact in degree $r + 1$ and that
the $r$th entry of $S$ is $T$-acyclic. Then, for every $n\in\Z$ different from $0$ and $-1$, we have
an isomorphism between the $n$th cohomology of $T(\Ker (S.d^{r+1}))$ and the
$(n + 1)$st homology of $T(\Ker (S.d^r))$.
\end{definition}

We turn to the proof of Lemma A.1.3(iv).

\begin{lemma}
\label{prop-rightAcyclic_ker_of_bounded_complex}
\lean{CategoryTheory.Functor.rightAcyclic_ker_of_bounded_complex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$, and let $k\in\Z$. 
Suppose that $S$ is exact in degree $\le k$, and that
the entries of $S$ are $T$-acyclic in degree $\le k$ and zero in small enough degree.

Then the homology of $T(\Ker (S.d^r))$ is zero in positive degree.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-rightAcyclic_ker_of_bounded_functor}
\lean{CategoryTheory.Functor.rightAcyclic_ker_of_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$, and let $k\in\Z$. 
Suppose that $S$ is exact in degree $\le k$, and that
the entries of $S$ are $T$-acyclic in degree $\le k$.

Then the homology of $T(\Ker (S.d^r))$ is zero in positive degree.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-leftAcyclic_ker_of_bounded_complex}
\lean{CategoryTheory.Functor.leftAcyclic_ker_of_boundedComplex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$, and let $k\in\Z$. 
Suppose that $S$ is exact in degree $> k$, and that
the entries of $S$ are $T$-acyclic in degree $\ge k$ and zero in large enough degree.

Then the homology of $T(\Ker (S.d^r))$ is zero in negative degree.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-leftAcyclic_ker_of_bounded_functor}
\lean{CategoryTheory.Functor.leftAcyclic_ker_of_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$, and let $k\in\Z$. 
Suppose that $S$ is exact in degree $> k$, and that
the entries of $S$ are $T$-acyclic in degree $\ge k$.

Then the homology of $T(\Ker (S.d^r))$ is zero in negative degree.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


From now on, we suppose that the t-structure $t'$ on $\Df'$ is non-degenerate.

\begin{lemma}
\label{prop-acyclic_ker_of_bounded_exact_acyclic_complex}
\lean{CategoryTheory.Functor.acyclic_ker_of_bounded_exact_acyclic_complex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact, and that
the entries of $S$ are $T$-acyclic in every degree and zero outside of a bounded interval.

Then $\Ker (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic_ker_of_exact_acyclic_complex_and_bounded_functor}
\lean{CategoryTheory.Functor.acyclic_ker_of_exact_acyclic_complex_and_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact  and that
the entries of $S$ are $T$-acyclic in every degree.

Then $\Ker (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic_image_of_bounded_exact_acyclic_complex}
\lean{CategoryTheory.Functor.acyclic_image_of_bounded_exact_acyclic_complex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact, and that
the entries of $S$ are $T$-acyclic in every degree and zero outside of a bounded interval.

Then $\Ima (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic_image_of_exact_acyclic_complex_and_bounded_functor}
\lean{CategoryTheory.Functor.acyclic_image_of_exact_acyclic_complex_and_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact  and that
the entries of $S$ are $T$-acyclic in every degree.

Then $\Ima (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic_coker_of_bounded_exact_acyclic_complex}
\lean{CategoryTheory.Functor.acyclic_coker_of_bounded_exact_acyclic_complex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact, and that
the entries of $S$ are $T$-acyclic in every degree and zero outside of a bounded interval.

Then $\Coker (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


\begin{lemma}
\label{prop-acyclic_coker_of_exact_acyclic_complex_and_bounded_functor}
\lean{CategoryTheory.Functor.acyclic_coker_of_exact_acyclic_complex_and_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact  and that
the entries of $S$ are $T$-acyclic in every degree.

Then $\Coker (S.d^r)$ is $T$-acyclic for every $k\in\Z$.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


Lemma A.3.1(iv)(a) :

\begin{lemma}
%Lemma A.3.1(iv)(a)
\label{prop-exact_map_of_exact_bounded_acyclic_complex}
\lean{CategoryTheory.CochainComplex.exact_map_of_exact_bounded_acyclic_complex}
\leanok 
\uses{def-hTh, def-acyclic}
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact, and that
the entries of $S$ are $T$-acyclic in every degree and zero outside of a bounded interval.

Then the image of $S$ by the functor $T'$ of Definition~\ref{def-hTh} is exact.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


Lemma A.3.1(iv)(b):

\begin{lemma}
%Lemma A.3.1(iv)(b)
\label{prop-exact_map_of_exact_acyclic_complex_and_bounded_functor}
\lean{CategoryTheory.CochainComplex.exact_map_of_exact_acyclic_complex_and_bounded_functor}
\leanok 
\uses{def-hTh, def-acyclic}
Suppose that $T$ has finite cohomological dimension (relative to the t-structures $t$ and $t'$).
Let $S$ be a cochain complex in $\Df^\heart$.
Suppose that $S$ is exact  and that
the entries of $S$ are $T$-acyclic in every degree.

Then the image of $S$ by the functor $T'$ of Definition~\ref{def-hTh} is exact.

\end{lemma}

\begin{proof}
\leanok
%  \uses{thm:open_ample, lem:open_ample_immersion}
\end{proof}


There is no explicit formalization of Lemma A.3.1(v).


\section{Functor reconstruction}

We keep the notation of the previous subsection, and we assume that the t-structure $t'$ on $\Df'$ is 
non-degenerate. We also assume that we have filtered triangulated categories $\DF$ over $\Df$ and 
$\DF'$ over $\Df'$, equipped with compatible t-structures $tF$ and $tF'$, as well as a filtered triangulated 
functor $FT:\DF\to\DF'$ lifing $T:\Df\to\Df'$; this is condition (a) of Proposition A.3.2.

Condition (b) of Proposition A.3.2 says that the "obvious" functor from the bounded homotopy category of
complexes of $T$-acyclic objects in the heart $\Df$ to the derived category of the heart of $\Df$
is a localization functor for the class of morphisms with acyclic cone (i.e. quasi-isomorphisms).

First statement of Proposition A.3.2:
\begin{proposition}
\label{prop-AcyclicComplexAcyclic_image}
\lean{CategoryTheory.FilteredTriangulated.AcyclicComplexAcyclic_image}
\leanok 
\uses{def-acyclic, def-FilteredLifting, def-compatible}

The functor on the bounded homotopy categories induced by the functor $T''$ of 
Definition~\ref{def-fromAcyclic}
sends a (bounded) exact complex of $T$-acyclic objects to an exact complex.

\end{proposition}

\begin{definition}
\label{def-derived}
\lean{CategoryTheory.FilteredTriangulated.DerivedFunctor}
\leanok 
\uses{prop-AcyclicComplexAcyclic_image}

The functor $DT:\Db(\Df^\heart)\to\Db({\Df'}^\heart)$ given by the universal property of the 
localization functor of condition (b) above, and the property proved in Proposition~\ref{prop-AcyclicComplexAcyclic_image}.

\end{definition}

Second statement of Proposition A.3.2:

\begin{definition}
\label{def-derived_comp}
\lean{CategoryTheory.FilteredTriangulated.DerivedFunctor_comp}
\leanok 
\uses{def-derived}

There is an isomorphism of functors $\real'\circ DT\iso T\circ\real$.

\end{definition}

\begin{tikzcd}
\Db(\Df^\heart)\ar[r, "DT"]\ar[d, "\real"'] &\Db({\Df'}^\heart)\ar[d, "\real'"]
\\
\Df\ar[r, "T"'] &\Df'
\end{tikzcd}


\begin{remark}
Suppose that we are in the situation of Proposition~A.3.2.
If moreover $T\colon \Df\ra\Df'$ is left t-exact and if $\If$ is cogenerating in $\Cf$ (i.e. every object of $\Cf$ has a monomorphism into an object of $\If$), then the functor
$\H^0(T)\colon \Cf\ra\Cf'$ admits a right derived functor $RT\colon \Dpl(\Cf)\ra\Dpl(\Cf')$ by Proposition~13.3.5 of~\cite{KS1}, and the construction of $RT$ in that proposition shows that
$RT$ sends that $\Db(\Cf)$ to $\Db(\Cf')$ and that $DT$ is the restriction of $RT$ to $\Db(\Cf)$. We have a similar statement if $T$ is right t-exact and $\If$ is generating in $\Cf$.

\label{rmk_der_fil1}
\end{remark}

\begin{remark}
By Proposition~10.2.7 of~\cite{KS1}, to check assumption (b) of Proposition~A.3.2, it suffices to find triangulated subcategories
$\Df_0=\Kb(\Cf)\supset\Df_1\supset\ldots\supset\Df_r=\Kb(\If)$ of $\Kb(\Cf)$ such that, for every $i\in\{1,\ldots,r-1\}$, one of the following conditions holds:
\begin{itemize}
\item For every $X\in\Ob\Df_i$, there exists a quasi-isomorphism $X\ra Y$ with $Y\in\Ob\Df_{i+1}$.
\item For every $X\in\Ob\Df_i$, there exists a quasi-isomorphism $Y\ra X$ with $Y\in\Ob\Df_{i+1}$.

\end{itemize}

\label{rmk_der_fil2}
\end{remark}

\begin{remark}
The statement of Definition~\ref{def-derived_comp} is not sufficient for our purposes, as we 
need the isomorphism to have some compatibilities, in at least the following ways:
\begin{itemize}
\item[(i)] If we have a commutative (up to isomorphism) diagram 
\begin{tikzcd}
\DF_1\ar[r, "U"]\ar[d, "FT_1"'] &\DF_2\ar[d, "FT_2"]
\\
\DF_1'\ar[r, "U'"'] &\DF_2'
\end{tikzcd}
(probably with t-exact functors $U$ and $U'$),
then we want to get a commutative (up to isomorphism) diagram
\begin{tikzcd}
\Db(\Df_1^\heart)\ar[d, "DT_1"']\ar[r, "U"] &\Db(\Df_2^\heart)\ar[d, "DT_2"]
\\
\Db({\Df_1'}^\heart)\ar[r, "U'"'] & \Db({\Df_2'}^\heart)
\end{tikzcd}

\item[(ii)] If we have functors $\DF\xra{FT}\DF'\xra{FT'}\DF''$ over $\Df\xra{T}\Df'\xra{T'}\Df''$,
we want an isomorphism $DT\circ DT'\iso D(T\circ T')$, satisfying the cocycle condition and also
compatible with the situation of (i).

\end{itemize}

Some of these issue show up after Definition~7.1.4 of the paper, and a solution is outlined.

\end{remark}